<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PRODUCTS</title>
  </head>
  <body>
    <header></header>
    <div class="main-container">
      <div class="form-wrap">
        <form>
          <label for="name">Name</label>
          <input type="text" id="name" placeholder="Enter your product" />
          <br />
          <label for="price">Price</label>
          <input type="text" id="price" />
          <br />
          <label for="currency">Currency</label>
          <input type="text" id="currency" />
          <br />
          <label for="qty">Quantity</label>
          <input type="text" id="qty" />
          <br />
          <input type="submit" id="addProduct" value="Add Product" />
        </form>
      </div>
    </div>
    <script>
      window.addEventListener("load", function () {
        // fetchPost();
        var submit = document.getElementById("addProduct");
        submit.addEventListener("click", handleSubmit);
      });

      async function handleSubmit(e) {
        e.preventDefault();
        var name = document.getElementById("name").value;
        var price = document.getElementById("price").value;
        var curr = document.getElementById("currency").value;
        var qty = document.getElementById("qty").value;

        console.log(name, price, curr, qty);

        var post = await postProduct({ name, price, curr, qty });

        await fetchPost();
      }

      function postProduct(data) {
        var config = {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        };

        return fetch("http://localhost:3001/products", config).then(function (
          response
        ) {
          return response.json();
        });
      }

      async function fetchPost() {
        const result = await getPost();
        display(result);
      }

      function getPost() {
        return fetch("http://localhost:3001/products").then(function (
          response
        ) {
          return response.json();
        });
      }

      function display(res) {}
    </script>
  </body>
</html>
